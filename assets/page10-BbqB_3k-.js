import"./modulepreload-polyfill-B5Qt9EMX.js";import{j as U,T as m,k as _,U as k,A as v}from"./index-DDZL8cFr.js";import{A as M}from"./Assets-C6Aos3Kt.js";import{M as P}from"./MeshPlane-4D_MrwNj.js";import{R as b}from"./RenderTexture-DGld5Ob5.js";import"./BitmapFontManager-De3LcqO4.js";import"./getCanvasFillStyle-Bhfzdggk.js";import"./CanvasPool-AohZQnYu.js";import"./Mesh-CyTsQIlS.js";import"./State-3sV0XrC-.js";import"./MeshGeometry-CnjuezGW.js";import"./PlaneGeometry-DKGD5EZF.js";class f extends U{constructor(...t){let e=t[0];Array.isArray(t[0])&&(e={textures:t[0],autoUpdate:t[1]});const{animationSpeed:i=1,autoPlay:r=!1,autoUpdate:s=!0,loop:n=!0,onComplete:T=null,onFrameChange:p=null,onLoop:h=null,textures:l,updateAnchor:g=!1,...x}=e,[u]=l;super({...x,texture:u instanceof m?u:u.texture}),this._textures=null,this._durations=null,this._autoUpdate=s,this._isConnectedToTicker=!1,this.animationSpeed=i,this.loop=n,this.updateAnchor=g,this.onComplete=T,this.onFrameChange=p,this.onLoop=h,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=l,r&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(_.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(_.shared.add(this.update,this,k.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=t.deltaTime,i=this.animationSpeed*e,r=this.currentFrame;if(this._durations!==null){let s=this._currentTime%1*this._durations[this.currentFrame];for(s+=i/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=i;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this._updateTexture())}_updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this.texture=this._textures[t],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t=!1){if(typeof t=="boolean"?t:t?.texture){const i=typeof t=="boolean"?t:t?.textureSource;this._textures.forEach(r=>{this.texture!==r&&r.destroy(i)})}this._textures=[],this._durations=null,this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let i=0;i<t.length;++i)e.push(m.from(t[i]));return new f(e)}static fromImages(t){const e=[];for(let i=0;i<t.length;++i)e.push(m.from(t[i]));return new f(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof m)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(_.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(_.shared.add(this.update,this),this._isConnectedToTicker=!0))}}async function I(){const a=new v;await a.init({backgroundAlpha:0,width:600,height:500,resolution:window.devicePixelRatio||1,autoDensity:!0}),a.canvas.id="app-canvas",document.querySelector(".page").appendChild(a.canvas);const t=await M.load("../img/wave2.png"),e=new P({texture:t,verticesX:10,verticesY:10});e.width=600,e.height=500;const i=e.geometry.getAttribute("aPosition"),{buffer:r}=i,s=r.data.slice(),n=.2,T=6,p=Math.round(2*Math.PI/n)*1.5,h=[],l=e.width*.66,g=e.height*.33,x=e.height*.66;for(let F=0;F<p;F++){const w=F/p*(2*Math.PI/n),c=s.slice();for(let o=0;o<c.length;o+=2){const S=c[o],C=c[o+1];S>l&&C>g&&C<x&&(c[o+1]+=Math.sin(w*.8+o)*T)}r.data=c,r.update();const y=b.create({width:600,height:500});a.renderer.render(e,{renderTexture:y}),h.push(y)}const u=h.slice(0,-1).reverse(),A=[...h,...u],d=new f(A);d.animationSpeed=.13,d.loop=!0,d.play(),a.stage.addChild(d),r.data=s,r.update()}I();
