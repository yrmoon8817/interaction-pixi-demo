import"./modulepreload-polyfill-B5Qt9EMX.js";import{h as U,T as m,i as _,U as v,A as k}from"./index-z_3bUTQL.js";import{A as M}from"./Assets-Bzd_MVb1.js";import{M as P}from"./MeshPlane-xRGsYOB8.js";import{R as I}from"./RenderTexture-DRp0-QYY.js";import"./BitmapFontManager-BPWCUObT.js";import"./CanvasTextMetrics-Bea0LAic.js";import"./CanvasPool-D7UiZzQ0.js";import"./Mesh-Cg2u8nkR.js";import"./State-3sV0XrC-.js";import"./MeshGeometry-PledSFX2.js";import"./PlaneGeometry-C-6gH1rH.js";class f extends U{constructor(...t){let e=t[0];Array.isArray(t[0])&&(e={textures:t[0],autoUpdate:t[1]});const{animationSpeed:i=1,autoPlay:s=!1,autoUpdate:r=!0,loop:n=!0,onComplete:g=null,onFrameChange:c=null,onLoop:h=null,textures:l,updateAnchor:T=!1,...x}=e,[u]=l;super({...x,texture:u instanceof m?u:u.texture}),this._textures=null,this._durations=null,this._autoUpdate=r,this._isConnectedToTicker=!1,this.animationSpeed=i,this.loop=n,this.updateAnchor=T,this.onComplete=g,this.onFrameChange=c,this.onLoop=h,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=l,s&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(_.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(_.shared.add(this.update,this,v.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=t.deltaTime,i=this.animationSpeed*e,s=this.currentFrame;if(this._durations!==null){let r=this._currentTime%1*this._durations[this.currentFrame];for(r+=i/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=i;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):s!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<s||this.animationSpeed<0&&this.currentFrame>s)&&this.onLoop(),this._updateTexture())}_updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this.texture=this._textures[t],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(){this.stop(),super.destroy(),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let i=0;i<t.length;++i)e.push(m.from(t[i]));return new f(e)}static fromImages(t){const e=[];for(let i=0;i<t.length;++i)e.push(m.from(t[i]));return new f(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof m)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(_.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(_.shared.add(this.update,this),this._isConnectedToTicker=!0))}}async function b(){const a=new k;await a.init({backgroundAlpha:0,width:600,height:500,resolution:window.devicePixelRatio||1,autoDensity:!0}),a.canvas.id="app-canvas",document.querySelector(".page").appendChild(a.canvas);const t=await M.load("../img/wave2.png"),e=new P({texture:t,verticesX:10,verticesY:10});e.width=600,e.height=500;const i=e.geometry.getAttribute("aPosition"),{buffer:s}=i,r=s.data.slice(),n=.2,g=6,c=Math.round(2*Math.PI/n)*1.5,h=[],l=e.width*.66,T=e.height*.33,x=e.height*.66;for(let F=0;F<c;F++){const w=F/c*(2*Math.PI/n),p=r.slice();for(let o=0;o<p.length;o+=2){const S=p[o],C=p[o+1];S>l&&C>T&&C<x&&(p[o+1]+=Math.sin(w*.8+o)*g)}s.data=p,s.update();const y=I.create({width:600,height:500});a.renderer.render(e,{renderTexture:y}),h.push(y)}const u=h.slice(0,-1).reverse(),A=[...h,...u],d=new f(A);d.animationSpeed=.13,d.loop=!0,d.play(),a.stage.addChild(d),s.data=r,s.update()}b();
